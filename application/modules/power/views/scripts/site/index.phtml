<?php
	$this->title = "BBA Sites";
	$this->headTitle($this->title);

    echo $this->siteSearchForm;
    /* @var $site Power_Model_Site */
?>

<?php echo $this->partial('_table-head.phtml', array(
    'heading'   => 'Sites',
    'label'     => 'New Site',
    'location'  => $this->url(array(
        'controller'    => 'site',
        'action'        => 'add'
    ), 'default', true)
)); ?>

<table>
	<tr>
	<th>Client <span class="id">(id)</span></th>
    <th>Site</th>
	<th>&nbsp;</th>
	</tr>
    <?php foreach($this->sites as $site): ?>
	<tr>
		<td>
            <?php echo $this->escape($site->client_name);?>&nbsp;
            <span class="id">(<?php echo $this->escape($site->id); ?>)</span>
        </td>
		<td><?php echo $this->formatSiteAddress(array(
            $this->escape($site->clientAd_address1), $this->escape($site->clientAd_address2),
            $this->escape($site->clientAd_address3), $this->escape($site->clientAd_postcode)
        )); ?></td>
		<td class="action">
			<button dojoType="dijit.form.Button" type="button">
                Edit
                <script type="dojo/method" event="onClick" args="evt">
                    location.href = "<?php echo $this->url(array(
                        'controller'    => 'site',
                        'action'        => 'edit',
                        'siteId'        => $site->id
                    )); ?>";
                </script>
            </button>
        </td>
	</tr>
    <?php endforeach;?>
</table>

<?php
if ($this->sites instanceof Zend_Paginator) {
    echo $this->paginationControl(
            $this->sites,
            'Sliding',
            '_paginate.phtml',
            array('params' => $this->search)
    );
}
?>
