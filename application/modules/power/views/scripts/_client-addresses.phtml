<?php echo $this->partial('_table-head.phtml', array(
    'heading'   => 'Client Addresses',
    'label'     => 'New Address',
    'location'  => $this->url(array(
        'controller'    => 'client-address',
        'action'        => 'add',
        'clientId'      => $this->clientId
    ), 'default', true)
)); ?>

<script>
    var addressStore = <?php echo $this->addressStore; ?>;
    dojo.addOnLoad(function(){
        dojo.connect(addressGrid, "onRowClick", function(val){
            selectedIndex = this.focus.rowIndex;
            selectedItem = this.getItem(selectedIndex);
            //Not sure if this is the most efficient way but it worked for me
            addressId = this.store.getValue(selectedItem, "clientAd_idAddress");

            location.href = '/client-address/edit/clientId/<?php echo $this->clientId; ?>/addressId/' + addressId;
        });
    });

</script>

<div dojotype="dojo.data.ItemFileReadStore"
     jsid="tableAddressStore"
     data="addressStore"></div>

<table dojoType="dojox.grid.DataGrid"
       jsId="addressGrid"
       store="tableAddressStore"
       query="{ clientAd_idAddress: '*' }"
       style="margin:auto;"
       autoWidth="false"
       autoHeight="20"
       rowSelector="0px"
       rowsPerPage="25"
       noDataMessage="<span class='dojoxGridNoData'>This Client has no addresses yet.</span>">
    <thead>
        <tr>
            <th field="clientAd_idAddress" width="75">Id</th>
            <th field="clientAd_addressName" width="250">Address Name</th>
            <th field="clientAd_address1" width="300">Address 1</th>
            <th field="clientAd_address2" width="200">Address 2</th>
            <th field="clientAd_address3" width="100">Address 3</th>
            <th field="clientAd_postcode" width="100">Postcode</th>
            <th field="" width="auto"></th>
        </tr>
    </thead>
</table>
